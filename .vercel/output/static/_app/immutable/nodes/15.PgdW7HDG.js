import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as Ie,t as q,g as e,a as he,$ as De,s as o,b as v,m as g,c,r as n}from"../chunks/PWWI3Ue3.js";import{t as F,h as ke,e as b,a as J,s as m}from"../chunks/BC15lkC2.js";import{e as se,i as oe}from"../chunks/FrGZEVpv.js";import{r as I}from"../chunks/CjOiFDoo.js";import{s as ne,c as Se}from"../chunks/DBYvBCBS.js";import{b as h}from"../chunks/CO0VHtSE.js";import{i as $e}from"../chunks/BEc5jUYy.js";import{o as Ue,a as Te}from"../chunks/D93VaLay.js";import{c as we}from"../chunks/BIOqlViq.js";import{l as ye}from"../chunks/BLRFddlS.js";import"../chunks/C5OadaZi.js";var Ne=F('<div class="event-item svelte-t9g4cp"><div class="event-header svelte-t9g4cp"><span class="event-time svelte-t9g4cp"> </span> <span class="event-name svelte-t9g4cp"> </span></div> <pre class="event-data svelte-t9g4cp"> </pre></div>'),Ee=F('<div><span class="log-time svelte-t9g4cp"> </span> <span class="log-message svelte-t9g4cp"> </span></div>'),xe=F('<div class="socket-debug-container svelte-t9g4cp"><h1 class="svelte-t9g4cp">Socket.IO Debug</h1> <div class="debug-controls svelte-t9g4cp"><div class="input-group svelte-t9g4cp"><label for="userId" class="svelte-t9g4cp">Your User ID:</label> <input id="userId" placeholder="Enter your user ID" class="svelte-t9g4cp"></div> <div class="input-group svelte-t9g4cp"><label for="targetUserId" class="svelte-t9g4cp">Target User ID:</label> <input id="targetUserId" placeholder="Enter target user ID for notifications" class="svelte-t9g4cp"></div> <div class="input-group svelte-t9g4cp"><label for="groupId" class="svelte-t9g4cp">Group ID:</label> <input id="groupId" placeholder="Enter group ID" class="svelte-t9g4cp"></div> <div class="input-group svelte-t9g4cp"><label for="groupName" class="svelte-t9g4cp">Group Name:</label> <input id="groupName" placeholder="Enter group name" class="svelte-t9g4cp"></div> <div class="button-group svelte-t9g4cp"><button class="primary svelte-t9g4cp">Connect Socket</button> <button class="warning svelte-t9g4cp">Disconnect</button></div> <div class="status-indicator svelte-t9g4cp">Socket Status: <span> </span></div></div> <div class="test-actions svelte-t9g4cp"><h2 class="svelte-t9g4cp">Test Socket Events</h2> <div class="button-group svelte-t9g4cp"><button class="svelte-t9g4cp">Test Group Invite</button> <button class="svelte-t9g4cp">Test Create Todo</button> <button class="svelte-t9g4cp">Test Role Change</button></div></div> <div class="debug-panels svelte-t9g4cp"><div class="debug-panel svelte-t9g4cp"><h2 class="svelte-t9g4cp">Socket Events</h2> <input placeholder="Filter events" class="filter-input svelte-t9g4cp"> <div class="event-list svelte-t9g4cp"></div></div> <div class="debug-panel svelte-t9g4cp"><h2 class="svelte-t9g4cp">Log Messages</h2> <div class="log-list svelte-t9g4cp"></div></div></div></div>');function ze(ae,ce){Ie(ce,!1);let l=g(""),u=g(""),d=g(""),f=g("Test Group"),$=g([]),U=g([]),D=g(""),r=g(null),A="http://localhost:3001";const ie=we.subscribe(t=>{});function a(t,s="info"){const i=new Date().toLocaleTimeString();v($,[{timestamp:i,message:typeof t=="object"?JSON.stringify(t,null,2):String(t),type:s},...e($)])}function le(t,s){const i=new Date().toLocaleTimeString();v(U,[{timestamp:i,event:t,data:typeof s=="object"?JSON.stringify(s,null,2):String(s)},...e(U)])}function Y(){if(!e(l)){a("Please enter a user ID","error");return}try{e(r)&&(e(r).disconnect(),v(r,null),a("Disconnected previous socket","warning")),a(`Connecting to socket server at ${A}...`,"info"),v(r,ye(A,{withCredentials:!0,autoConnect:!0,auth:{userId:e(l)}})),e(r).on("connect",()=>{var t,s;a(`Direct socket connected with ID: ${(t=e(r))==null?void 0:t.id}`,"success"),(s=e(r))==null||s.emit("join:groups",{groupIds:e(d)?[e(d)]:[]})}),e(r).on("disconnect",()=>{a("Direct socket disconnected","warning")}),e(r).on("connect_error",t=>{a(`Direct socket connection error: ${t.message}`,"error"),console.error("Socket connection error details:",t)}),e(r).onAny((t,...s)=>{le(t,s[0]),a(`Received event: ${t}`,"info"),console.log(`[Socket Debug] Event ${t}:`,s)})}catch(t){const s=t instanceof Error?t.message:"Unknown error";a(`Error connecting to socket: ${s}`,"error")}}function de(){e(r)&&(e(r).disconnect(),v(r,null),a("Disconnected direct socket","warning"))}function ve(){if(!e(r)||!e(r).connected){a("Socket not connected","error");return}if(!e(u)||!e(d)){a("Target user ID and group ID are required","error");return}e(r).emit("direct:group_invite",{targetUserId:e(u),groupId:e(d),groupName:e(f),inviterName:`User ${e(l)}`,groupDescription:"This is a test group invitation"}),a(`Sent direct invite to user ${e(u)} for group ${e(d)}`,"success")}function pe(){if(!e(r)||!e(r).connected){a("Socket not connected","error");return}if(!e(d)){a("Group ID is required","error");return}e(r).emit("todo:created",{todo:{_id:`test_${Date.now()}`,title:`Test Todo Created at ${new Date().toLocaleTimeString()}`,description:"This is a test todo",priority:"high"},groupId:e(d),groupName:e(f),username:`User ${e(l)}`}),a(`Sent todo:created event to group ${e(d)}`,"success")}function ue(){if(!e(r)||!e(r).connected){a("Socket not connected","error");return}if(!e(u)||!e(d)){a("Target user ID and group ID are required","error");return}e(r).emit("group:user_role_changed",{userId:e(u),groupId:e(d),groupName:e(f),newRole:"co-lead",adminName:`User ${e(l)}`}),a(`Sent role change event for user ${e(u)} in group ${e(d)}`,"success")}function ge(){{try{const i=localStorage.getItem("user");if(i){const p=JSON.parse(i);if(p&&p._id){v(l,p._id),a(`User ID loaded from storage: ${e(l)}`,"info"),setTimeout(()=>{e(l)&&!e(r)&&Y()},500);return}}}catch(i){console.error("Error reading user from localStorage:",i)}const s=new URLSearchParams(window.location.search).get("userId");s?(v(l,s),a(`User ID set from URL parameter: ${e(l)}`,"info")):a("No user ID found in storage or URL. Please enter it manually.","warning")}}Ue(()=>{ge(),a("Socket Debug Page Loaded","info")}),Te(()=>{ie(),e(r)&&e(r).disconnect()}),$e();var T=xe();ke(t=>{De.title="Socket.IO Debug"});var w=o(c(T),2),y=c(w),z=o(c(y),2);I(z),n(y);var N=o(y,2),B=o(c(N),2);I(B),n(N);var E=o(N,2),H=o(c(E),2);I(H),n(E);var x=o(E,2),K=o(c(x),2);I(K),n(x);var C=o(x,2),L=c(C),me=o(L,2);n(C);var Q=o(C,2),R=o(c(Q)),fe=c(R,!0);n(R),n(Q),n(w);var O=o(w,2),V=o(c(O),2),P=c(V),G=o(P,2),W=o(G,2);n(V),n(O);var X=o(O,2),M=c(X),j=o(c(M),2);I(j);var Z=o(j,2);se(Z,5,()=>e(U).filter(t=>!e(D)||t.event.includes(e(D))),oe,(t,s)=>{var i=Ne(),p=c(i),_=c(p),k=c(_,!0);n(_);var S=o(_,2),_e=c(S,!0);n(S),n(p);var re=o(p,2),be=c(re,!0);n(re),n(i),q(()=>{m(k,e(s).timestamp),m(_e,e(s).event),m(be,e(s).data)}),J(t,i)}),n(Z),n(M);var ee=o(M,2),te=o(c(ee),2);se(te,5,()=>e($),oe,(t,s)=>{var i=Ee(),p=c(i),_=c(p,!0);n(p);var k=o(p,2),S=c(k,!0);n(k),n(i),q(()=>{ne(i,1,`log-item ${e(s).type??""}`,"svelte-t9g4cp"),m(_,e(s).timestamp),m(S,e(s).message)}),J(t,i)}),n(te),n(ee),n(X),n(T),q(()=>{L.disabled=!e(l),ne(R,1,Se(e(r)&&e(r).connected?"connected":"disconnected"),"svelte-t9g4cp"),m(fe,e(r)&&e(r).connected?"Connected":"Disconnected"),P.disabled=!e(r)||!e(r).connected,G.disabled=!e(r)||!e(r).connected,W.disabled=!e(r)||!e(r).connected}),h(z,()=>e(l),t=>v(l,t)),h(B,()=>e(u),t=>v(u,t)),h(H,()=>e(d),t=>v(d,t)),h(K,()=>e(f),t=>v(f,t)),b("click",L,Y),b("click",me,de),b("click",P,ve),b("click",G,pe),b("click",W,ue),h(j,()=>e(D),t=>v(D,t)),J(ae,T),he()}export{ze as component};
