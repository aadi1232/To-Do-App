import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{B as le,p as X,c as u,s as y,r as v,g as e,m as j,t as W,b as o,a as ee,f as oe,n as ge}from"../chunks/PWWI3Ue3.js";import{t as g,s as Z,e as _,a as p,j as he}from"../chunks/BC15lkC2.js";import{i as L}from"../chunks/BsCQza_p.js";import{i as te}from"../chunks/BEc5jUYy.js";import{a as me,o as se}from"../chunks/D93VaLay.js";import"../chunks/C5OadaZi.js";import"../chunks/DXySWGYQ.js";import{e as ie,i as de}from"../chunks/FrGZEVpv.js";import{r as G,s as ce,a as be}from"../chunks/CjOiFDoo.js";import{t as ye,s as ae,c as xe}from"../chunks/DBYvBCBS.js";import{b as re,a as we}from"../chunks/CO0VHtSE.js";import{p as _e}from"../chunks/CWmzcjye.js";import{w as ke}from"../chunks/CNzxuJyc.js";import{b as Te,e as ne,f as Ce,i as je,a as Me,h as Se}from"../chunks/CWcjEGFN.js";import{a as Ee,s as De}from"../chunks/6avubi_o.js";import{t as ve,f as ue}from"../chunks/CtkfvfXh.js";import{p as Ae}from"../chunks/LNgpw9vD.js";function fe(D,I,a,t){var l=D.__style;if(le||l!==I){var r=ye(I);(!le||r!==D.getAttribute("style"))&&(r==null?D.removeAttribute("style"):D.style.cssText=r),D.__style=I}return t}function Le(){const{subscribe:D,set:I,update:a}=ke([]);return{subscribe:D,fetchTodos:async()=>{try{const t=await je();return I(t),t}catch(t){return console.error("Error fetching todos:",t),[]}},addTodo:async t=>{try{const r=await Ce(typeof t=="string"?{title:t}:t);return a(i=>[r,...i]),r}catch(l){return console.error("Error adding todo:",l),null}},updateTodo:async(t,l)=>{let r;a(i=>{const n=i.findIndex(S=>S._id===t);if(n===-1)return i;r=i[n];const m=[...i];return m[n]={...m[n],...l},m});try{const i=await ne(t,l);return a(n=>n.map(m=>m._id===t?i:m)),i}catch(i){return console.error("Error updating todo:",i),r&&a(n=>n.map(m=>m._id===t?r:m)),null}},toggleTodo:async t=>{let l;return a(r=>{const i=r.find(n=>n._id===t);return i?(l={...i},r.map(n=>n._id===t?{...n,completed:!n.completed}:n)):r}),l?await ne(t,{completed:!l.completed}):null},deleteTodo:async t=>{let l,r=-1;a(i=>{if(r=i.findIndex(m=>m._id===t),r===-1)return i;l=i[r];const n=[...i];return n.splice(r,1),n});try{return await Te(t),!0}catch(i){return console.error("Error deleting todo:",i),l&&r!==-1&&a(n=>{const m=[...n];return m.splice(r,0,l),m}),!1}},moveTodoToTop:async t=>{try{let l;return a(r=>{if(l=r.find(n=>n._id===t),!l)return r;const i=r.filter(n=>n._id!==t);return[l,...i]}),l||null}catch(l){return console.error("Error moving todo to top:",l),null}}}}const Q=Le();var Ie=g('<div class="flex flex-col items-center py-3"><div class="mb-2 h-6 w-6 animate-spin rounded-full border-2 border-gray-300 border-t-blue-500"></div> <p class="text-xs text-gray-500">AI is generating suggestions...</p></div>'),$e=g("<div> </div>"),Be=g('<p class="px-3 py-2 text-xs font-medium text-gray-500">AI suggestions:</p> <!>',1),ze=g('<div class="absolute top-full right-0 left-0 z-10 mt-1 rounded-md border border-gray-200 bg-white shadow-lg"><div class="py-1"><!></div></div>'),Ue=g('<div class="relative"><form class="flex gap-2"><div class="relative flex-1"><div class="flex items-center gap-2"><input type="text" placeholder="Add a new todo..." class="flex-1 rounded-md border border-gray-300 px-4 py-2 focus:border-black focus:ring-1 focus:ring-black focus:outline-none"> <input type="color" class="h-8 w-8 cursor-pointer rounded border border-gray-300 p-1" title="Choose text color"> <button type="button" title="Toggle highlight"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg></button></div> <!></div> <button type="submit" class="rounded-md bg-black px-4 py-2 font-medium text-white hover:bg-gray-800 focus:ring-2 focus:ring-black focus:ring-offset-2 focus:outline-none"> </button></form></div>');function He(D,I){X(I,!1);let a=j(""),t=j([]),l=j(!1),r=j(!1),i=j(-1),n=null,m=j("#000000"),S=j(!1);async function P(){if(e(a).trim().length<2){o(t,[]),o(r,!1);return}o(l,!0);try{o(t,await Me(e(a))),o(r,e(t).length>0),o(i,-1)}catch(s){console.error("Error fetching suggestions:",s),o(t,[])}finally{o(l,!1)}}function E(){n&&clearTimeout(n),n=window.setTimeout(()=>{P()},500)}async function h(){if(e(a).trim())try{const s={title:e(a),textColor:e(m),isHighlighted:e(S)};await Q.addTodo(s),o(a,""),o(m,"#000000"),o(S,!1),o(t,[]),o(r,!1)}catch(s){console.error("Error adding todo:",s)}}function k(s){if(e(r))switch(s.key){case"ArrowDown":s.preventDefault(),o(i,Math.min(e(i)+1,e(t).length-1));break;case"ArrowUp":s.preventDefault(),o(i,Math.max(e(i)-1,-1));break;case"Enter":e(i)>=0&&e(i)<e(t).length&&(s.preventDefault(),o(a,e(t)[e(i)]),o(r,!1));break;case"Escape":s.preventDefault(),o(r,!1);break}}function M(s){o(a,s),o(r,!1)}me(()=>{n&&clearTimeout(n)}),te();var x=Ue(),f=u(x),w=u(f),A=u(w),C=u(A);G(C);var U=y(C,2);G(U);var q=y(U,2);v(A);var N=y(A,2);{var c=s=>{var d=ze(),b=u(d),R=u(b);{var z=H=>{var V=Ie();p(H,V)},F=H=>{var V=Be(),J=y(oe(V),2);ie(J,1,()=>e(t),de,($,B,O)=>{var Y=$e(),pe=u(Y,!0);v(Y),W(()=>{ae(Y,1,`cursor-pointer px-3 py-2 hover:bg-gray-100 ${O===e(i)?"bg-gray-100":""}`),Z(pe,e(B))}),_("mousedown",Y,()=>M(e(B))),_("mouseover",Y,()=>o(i,O)),p($,Y)}),p(H,V)};L(R,H=>{e(l)?H(z):H(F,!1)})}v(b),v(d),p(s,d)};L(N,s=>{e(r)&&s(c)})}v(w);var T=y(w,2),K=u(T,!0);v(T),v(f),v(x),W(()=>{fe(C,`color: ${e(m)??""};`),ae(q,1,`rounded border border-gray-300 p-1.5 ${e(S)?"bg-yellow-200":"bg-white"}`),T.disabled=e(l),Z(K,e(l)?"Adding...":"Add Todo")}),re(C,()=>e(a),s=>o(a,s)),_("input",C,E),_("keydown",C,k),_("blur",C,()=>{setTimeout(()=>{o(r,!1)},200)}),_("focus",C,()=>{e(t).length>0&&o(r,!0)}),re(U,()=>e(m),s=>o(m,s)),_("click",q,()=>o(S,!e(S))),_("submit",f,_e(h)),p(D,x),ee()}var Fe=g('<input type="text" class="flex-1 rounded border border-gray-300 px-2 py-1 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none">'),Pe=g("<span> </span>"),qe=g('<button class="rounded p-1 text-green-600 hover:bg-green-50" title="Save"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></button> <button class="rounded p-1 text-gray-600 hover:bg-gray-50" title="Cancel"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>',1),Re=g('<div class="flex items-center gap-2 rounded-md bg-red-50 px-3 py-1"><span class="text-sm text-red-600">Delete?</span> <button class="rounded p-1 text-red-600 hover:bg-red-100" title="Confirm Delete"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></button> <button class="rounded p-1 text-gray-600 hover:bg-gray-100" title="Cancel"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),Ve=g('<div class="flex items-center gap-2 rounded-md bg-gray-50 px-3 py-1"><span class="text-sm text-gray-600">Mark as completed?</span> <button class="rounded p-1 text-black hover:bg-gray-100"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></button></div>'),Je=g('<button class="rounded p-1 text-blue-600 hover:bg-blue-50" title="Edit"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="rounded p-1 text-red-600 hover:bg-red-50" title="Delete"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>',1),Ke=g('<div class="group flex items-center justify-between gap-2 rounded-md border p-3 shadow-sm transition-all hover:shadow-md"><div class="flex items-center gap-2"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-black focus:ring-black"> <!></div> <div class="flex items-center gap-2 opacity-0 transition-opacity group-hover:opacity-100"><!></div></div>');function Ne(D,I){X(I,!1);let a=Ae(I,"todo",12),t=j(!1),l=j(a().title),r=j(!1),i=!1,n=j(!1);function m(){o(t,!0),o(l,a().title)}async function S(){e(l).trim()&&(await Q.updateTodo(a()._id,{title:e(l)}),o(t,!1))}function P(){o(t,!1),o(l,a().title)}async function E(){e(r)?(await Q.deleteTodo(a()._id),o(r,!1)):o(r,!0)}function h(){o(r,!1)}function k(){o(n,!0)}async function M(){if(!i)try{i=!0,await Q.deleteTodo(a()._id),o(n,!1)}catch(s){console.error("Error completing todo:",s),a(a().completed=!a().completed,!0)}finally{i=!1}}function x(s){s.key==="Enter"?S():s.key==="Escape"&&P()}te();var f=Ke(),w=u(f),A=u(w);G(A);var C=y(A,2);{var U=s=>{var d=Fe();G(d),he(d),re(d,()=>e(l),b=>o(l,b)),_("keydown",d,x),_("blur",d,S),p(s,d)},q=s=>{var d=Pe(),b=u(d,!0);v(d),W(()=>{ae(d,1,xe(a().completed?"text-gray-500":"")),fe(d,`color: ${a().textColor||"#000000"}; background-color: ${a().isHighlighted?"#fef08a":"transparent"};`),Z(b,a().title)}),p(s,d)};L(C,s=>{e(t)?s(U):s(q,!1)})}v(w);var N=y(w,2),c=u(N);{var T=s=>{var d=qe(),b=oe(d),R=y(b,2);_("click",b,S),_("click",R,P),p(s,d)},K=(s,d)=>{{var b=z=>{var F=Re(),H=y(u(F),2),V=y(H,2);v(F),_("click",H,E),_("click",V,h),p(z,F)},R=(z,F)=>{{var H=J=>{var $=Ve(),B=y(u($),2);v($),_("click",B,M),p(J,$)},V=J=>{var $=Je(),B=oe($),O=y(B,2);_("click",B,m),_("click",O,E),p(J,$)};L(z,J=>{e(n)?J(H):J(V,!1)},F)}};L(s,z=>{e(r)?z(b):z(R,!1)},d)}};L(c,s=>{e(t)?s(T):s(K,!1)})}v(N),v(f),W(()=>ce(A,"id",`todo-${a()._id}`)),we(A,()=>a().completed,s=>a(a().completed=s,!0)),_("change",A,k),ve(3,f,()=>ue),p(D,f),ee()}var Oe=g('<div class="flex justify-center py-8"><div class="h-8 w-8 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"></div></div>'),Qe=g('<div class="mt-4 rounded-md bg-red-50 p-4 text-center text-red-700"> </div>'),We=g('<div class="mt-4 text-center text-gray-500"><p>No todo items yet. Add one above!</p></div>'),Ye=g('<div class="space-y-2"></div>'),Ze=g('<div class="mt-6"><!></div>');function Ge(D,I){X(I,!1);const[a,t]=Ee(),l=()=>De(Q,"$todos",a);let r=j(!0),i=j(null);se(async()=>{try{await Q.fetchTodos()}catch(E){o(i,E instanceof Error?E.message:"Failed to load todos")}finally{o(r,!1)}}),te();var n=Ze(),m=u(n);{var S=E=>{var h=Oe();p(E,h)},P=(E,h)=>{{var k=x=>{var f=Qe(),w=u(f,!0);v(f),W(()=>Z(w,e(i))),p(x,f)},M=(x,f)=>{{var w=C=>{var U=We();p(C,U)},A=C=>{var U=Ye();ie(U,5,l,q=>q._id,(q,N)=>{Ne(q,{get todo(){return e(N)}})}),v(U),p(C,U)};L(x,C=>{l().length===0?C(w):C(A,!1)},f)}};L(E,x=>{e(i)?x(k):x(M,!1)},h)}};L(m,E=>{e(r)?E(S):E(P,!1)})}v(n),p(D,n),ee(),t()}var Xe=g('<button type="button" class="absolute end-2.5 inset-y-0 my-auto h-6 w-6 flex items-center justify-center rounded-full text-gray-500 hover:bg-gray-100" aria-label="Clear search"><svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"></path></svg></button>'),et=g('<div class="mt-1 text-xs text-gray-500">Using basic search mode (Typesense not available)</div>'),tt=g('<div class="mt-2 flex justify-center"><div class="h-4 w-4 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"></div></div>'),rt=g('<p class="text-sm"><!></p>'),ot=g('<p class="text-sm"> </p>'),at=g('<li class="flex px-4 py-3"><div class="flex flex-grow items-center"><input type="checkbox" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"> <div class="ml-3 flex-grow cursor-pointer hover:bg-gray-50 rounded px-2 py-1"><!></div></div></li>'),st=g('<div class="mt-4 rounded-md border border-gray-200 bg-white shadow-sm"><ul class="divide-y divide-gray-100"></ul></div>'),it=g('<div class="mb-6"><div class="relative"><div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none"><svg class="w-4 h-4 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"></path></svg></div> <input type="search" class="block w-full p-2.5 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white focus:ring-blue-500 focus:border-blue-500" placeholder="Search todos..." aria-label="Search personal todos"> <!> <!></div> <!> <!></div>');function lt(D,I){X(I,!1);let a=j(""),t=j([]),l=j(!1),r=null,i=!1,n=j(!1);se(async()=>{try{const c=await fetch("/api/search/todos/sync",{method:"POST"});if(c.ok){const T=await c.json();o(n,T.fallback===!0),e(n)&&console.log("Using fallback search as Typesense is not available")}i=!0}catch(c){console.error("Failed to initialize search:",c),o(n,!0)}});async function m(){if(r&&clearTimeout(r),!e(a).trim()){o(t,[]);return}r=window.setTimeout(async()=>{o(l,!0);try{const c=e(a).trim(),T=encodeURIComponent(c);console.log(`Searching with query: ${c} (encoded: ${T})`);const K=new URL("/api/search/todos",window.location.origin);K.searchParams.append("query",c);const s=await fetch(K.toString());if(s.ok){const d=await s.json();console.log("Search results:",d),o(n,d.fallback===!0),d.hits&&Array.isArray(d.hits)?o(t,d.hits.map(b=>({_id:b.document.id,title:b.document.title,completed:b.document.completed,highlights:b.highlights?b.highlights.map(R=>R.snippet):[]}))):(console.warn("Unexpected search results format:",d),o(t,[]))}else{const d=await s.text();console.error(`Search failed (${s.status}):`,d);try{const b=JSON.parse(d);console.error("Error details:",b)}catch{}}}catch(c){console.error("Error during search:",c)}finally{o(l,!1)}},300)}function S(){o(a,""),o(t,[])}function P(c){Q.toggleTodo(c)}async function E(c){await Q.moveTodoToTop(c),S()}te();var h=it(),k=u(h),M=y(u(k),2);G(M);var x=y(M,2);{var f=c=>{var T=Xe();_("click",T,S),p(c,T)};L(x,c=>{e(a)&&c(f)})}var w=y(x,2);{var A=c=>{var T=et();p(c,T)};L(w,c=>{e(n)&&c(A)})}v(k);var C=y(k,2);{var U=c=>{var T=tt();p(c,T)};L(C,c=>{e(l)&&c(U)})}var q=y(C,2);{var N=c=>{var T=st(),K=u(T);ie(K,5,()=>e(t),de,(s,d)=>{var b=at(),R=u(b),z=u(R);G(z);var F=y(z,2),H=u(F);{var V=$=>{var B=rt(),O=u(B);Se(O,()=>e(d).highlights[0]),v(B),p($,B)},J=$=>{var B=ot(),O=u(B,!0);v(B),W(()=>Z(O,e(d).title)),p($,B)};L(H,$=>{e(d).highlights&&e(d).highlights.length>0?$(V):$(J,!1)})}v(F),v(R),v(b),W(()=>{be(z,e(d).completed),ce(z,"aria-label",`Toggle completion of todo: ${e(d).title}`)}),_("change",z,()=>P(e(d)._id)),_("click",F,()=>E(e(d)._id)),p(s,b)}),v(K),v(T),ve(3,T,()=>ue,()=>({duration:150})),p(c,T)};L(q,c=>{e(t).length>0&&c(N)})}v(h),re(M,()=>e(a),c=>o(a,c)),_("input",M,m),p(D,h),ee()}var nt=g('<div class="mx-auto mt-8 max-w-2xl"><h2 class="mb-6 text-center text-2xl font-medium">Your Todo List</h2> <div class="mb-4"><!></div> <div class="mb-6"><!></div> <!></div>'),dt=g('<div class="mt-16 text-center"><h2 class="text-lg font-medium">Welcome to the Todo App</h2> <p class="mt-2 text-gray-600">Please log in or sign up to get started.</p> <div class="mt-4"><a href="/auth/login" class="mx-2 inline-block rounded-md bg-black px-4 py-2 text-white hover:bg-gray-800">Log In</a> <a href="/auth/signup" class="mx-2 inline-block rounded-md border border-black px-4 py-2 text-black hover:bg-gray-100">Sign Up</a></div></div>'),ct=g('<div class="flex flex-col items-center justify-center py-16"><div class="h-12 w-12 animate-spin rounded-full border-4 border-gray-200 border-t-black"></div> <p class="mt-4 text-gray-600">Loading...</p></div>'),vt=g('<div class="fixed right-4 bottom-4 max-w-md rounded-md bg-yellow-100 p-4 shadow-md"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-yellow-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9 5a1 1 0 012 0v6a1 1 0 01-2 0V5zm1 9a1 1 0 100 2 1 1 0 000-2z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><h3 class="text-sm font-medium text-yellow-800">Database Connection Issue</h3> <div class="mt-1 text-xs text-yellow-700"><p> </p> <p class="mt-1">Some features may be unavailable. Please try again later.</p></div></div></div></div>'),ut=g('<div class="min-h-screen bg-white"><main class="container mx-auto p-4"><!></main> <!></div>');function Lt(D,I){X(I,!1);let a=j(null),t=j(!0),l=j(null);se(async()=>{try{const h=await fetch("/api/auth/me");if(h.ok)o(a,await h.json());else if(h.status===503){const k=await h.json();o(l,k.error||"Database unavailable")}}catch(h){console.error("Failed to fetch user:",h)}finally{o(t,!1)}}),te();var r=ut(),i=u(r),n=u(i);{var m=h=>{var k=nt(),M=y(u(k),2),x=u(M);lt(x,{}),v(M);var f=y(M,2),w=u(f);He(w,{}),v(f);var A=y(f,2);Ge(A,{}),v(k),p(h,k)},S=(h,k)=>{{var M=f=>{var w=dt();p(f,w)},x=f=>{var w=ct();p(f,w)};L(h,f=>{e(t)?f(x,!1):f(M)},k)}};L(n,h=>{e(a)?h(m):h(S,!1)})}v(i);var P=y(i,2);{var E=h=>{var k=vt(),M=u(k),x=y(u(M),2),f=y(u(x),2),w=u(f),A=u(w,!0);v(w),ge(2),v(f),v(x),v(M),v(k),W(()=>Z(A,e(l))),p(h,k)};L(P,h=>{e(l)&&h(E)})}v(r),p(D,r),ee()}export{Lt as component};
