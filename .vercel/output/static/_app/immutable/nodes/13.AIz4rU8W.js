import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as ir,a as dr,$ as lr,b as s,m as y,c as t,g as e,s as i,r,t as b,f as Pe,d as D,e as vr}from"../chunks/PWWI3Ue3.js";import{t as l,h as nr,a as d,s as m,e as T,c as cr}from"../chunks/BC15lkC2.js";import{i as p}from"../chunks/BsCQza_p.js";import{e as Be,i as Fe}from"../chunks/FrGZEVpv.js";import{r as mr,s as ee}from"../chunks/CjOiFDoo.js";import{s as pr}from"../chunks/DBYvBCBS.js";import{t as gr,f as ur}from"../chunks/CtkfvfXh.js";import{b as fr}from"../chunks/CO0VHtSE.js";import{i as br}from"../chunks/BEc5jUYy.js";import{o as _r}from"../chunks/D93VaLay.js";import{g as re}from"../chunks/C5OadaZi.js";import{a as xr,g as yr,r as hr}from"../chunks/BcYMahjX.js";var wr=l("<div> </div>"),Ir=l('<div class="flex h-64 items-center justify-center"><div class="animate-pulse text-gray-600">Loading profile...</div></div>'),kr=l('<div class="rounded-lg border border-gray-200 bg-white p-6 text-center shadow-sm"><p class="mb-4 text-gray-700"> </p> <button class="rounded bg-black px-4 py-2 text-white hover:bg-gray-800">Return to Login</button></div>'),Ur=l('<img class="h-32 w-32 rounded-full border-2 border-gray-200 object-cover">'),jr=l('<div class="flex h-32 w-32 items-center justify-center rounded-full border-2 border-gray-200 bg-gray-100 text-2xl font-semibold text-gray-700"> </div>'),Er=l('<div class="mt-3 rounded bg-gray-100 p-3 text-gray-700">Profile image updated successfully!</div>'),Ar=l('<div class="mt-3 rounded bg-red-50 p-3 text-red-800"> </div>'),Lr=l('<div class="py-4 text-center text-gray-600"><div class="animate-pulse">Loading groups...</div></div>'),Dr=l('<div class="rounded bg-red-50 p-3 text-red-800"> </div>'),Gr=l('<p class="py-4 text-center text-gray-600">You are not a member of any groups yet.</p>'),Pr=l('<img class="h-16 w-16 rounded-full border-2 border-gray-200 object-cover">'),Br=l('<div class="flex h-16 w-16 items-center justify-center rounded-full border-2 border-gray-200 bg-gray-100 text-xl font-semibold text-gray-700"> </div>'),Fr=l('<p class="mt-1 text-xs text-gray-500"> </p>'),Tr=l('<li class="mb-4 flex flex-col justify-between gap-4 rounded border border-gray-200 bg-white p-4 py-4 shadow-sm sm:flex-row"><div class="flex items-center gap-3"><!> <div><h4 class="text-lg font-medium"> </h4> <p class="mt-1 text-sm text-gray-600"> </p> <!></div></div> <div class="self-center"><button class="rounded bg-black px-4 py-2 text-sm text-white hover:bg-gray-800">View Group</button></div></li>'),Cr=l('<ul class="space-y-4"></ul>'),Mr=l('<div class="py-4 text-center text-gray-600"><div class="animate-pulse">Loading invitations...</div></div>'),Rr=l('<p class="text-gray-600">No pending invitations</p>'),Sr=l('<p class="mt-1 text-sm text-gray-600"> </p>'),Nr=l('<p class="mt-1 text-sm text-gray-600"> </p>'),Yr=l('<li class="mb-4 flex flex-col justify-between gap-4 rounded border border-gray-200 bg-white p-4 py-4 shadow-sm sm:flex-row"><div><h4 class="text-lg font-medium"> </h4> <!> <p class="mt-1 text-xs text-gray-500"> </p></div> <div class="flex gap-2 sm:self-center"><button class="rounded bg-black px-4 py-2 text-sm text-white hover:bg-gray-800">Accept</button> <button class="rounded border border-gray-300 px-3 py-1 text-sm hover:bg-gray-100">Decline</button></div></li>'),qr=l('<ul class="space-y-4"></ul>'),zr=l('<h1 class="mb-6 border-b border-gray-200 pb-2 text-2xl font-bold">User Profile</h1> <div class="mb-6 rounded-lg border border-gray-200 bg-white p-6 shadow-sm"><div class="flex flex-col items-center gap-6 md:flex-row md:items-start"><div class="relative h-32 w-32"><!></div> <div><h2 class="text-xl font-semibold"> </h2> <p class="mt-1 text-gray-600"> </p> <p class="mt-2 text-sm text-gray-500"> </p></div></div></div> <div class="mb-6 rounded-lg border border-gray-200 bg-white p-6 shadow-sm"><h3 class="mb-4 border-b border-gray-200 pb-2 text-lg font-semibold">Update Profile Image</h3> <div class="flex flex-col gap-3 sm:flex-row"><input type="text" placeholder="Enter image URL" class="flex-grow rounded border border-gray-300 px-3 py-2"> <button class="rounded bg-black px-4 py-2 text-white hover:bg-gray-800">Update Image</button></div> <!> <!></div> <div class="mb-6 rounded-lg border border-gray-200 bg-white p-6 shadow-sm"><div class="mb-4 flex items-center justify-between border-b border-gray-200 pb-2"><h3 class="text-lg font-semibold">My Groups</h3> <button class="rounded bg-black px-3 py-1 text-sm text-white hover:bg-gray-800">Create Group</button></div> <!></div> <div class="rounded-lg border border-gray-200 bg-white p-6 shadow-sm"><h3 class="mb-4 border-b border-gray-200 pb-2 text-lg font-semibold">Group Invitations</h3> <!></div>',1),Jr=l('<div class="min-h-screen bg-white"><!> <div class="container mx-auto max-w-4xl p-6"><!></div></div>');function st(Te,Ce){ir(Ce,!1);let c=y(null),te=y(!0),ae=y(null),G=y(""),oe=y(!1),C=y(null),se=y([]),ie=y([]),M=y(!0),H=y(null),P=y(null),de=y("success");_r(async()=>{try{const o=await fetch("/api/auth/me");if(!o.ok){if(o.status===401){re("/auth/login");return}throw new Error("Failed to fetch profile data")}s(c,await o.json()),s(te,!1),await he()}catch(o){console.error("Error loading profile:",o),s(ae,o instanceof Error?o.message:"Failed to load profile"),s(te,!1)}});async function he(){try{s(M,!0),s(H,null),s(se,await xr()),s(ie,await yr()),s(M,!1)}catch(o){console.error("Error loading group data:",o),s(H,o instanceof Error?o.message:"Failed to load group data"),s(M,!1)}}async function Me(){if(!e(G).trim()){s(C,"Please enter a valid image URL");return}try{if(s(oe,!1),s(C,null),!(await fetch("/api/users/profile/image",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({profileImage:e(G)})})).ok)throw new Error("Failed to update profile image");e(c)&&vr(c,e(c).profileImage=e(G)),s(G,""),s(oe,!0)}catch(o){console.error("Error updating profile image:",o),s(C,o instanceof Error?o.message:"Failed to update profile image")}}async function we(o,f){try{await hr(o,f),s(P,f==="accepted"?"You have joined the group!":"Invitation declined"),s(de,"success"),await he(),setTimeout(()=>{s(P,null)},3e3)}catch(R){console.error(`Error ${f} invite:`,R),s(P,`Failed to ${f} invitation`),s(de,"error"),setTimeout(()=>{s(P,null)},3e3)}}br();var le=Jr();nr(o=>{lr.title="User Profile"});var Ie=t(le);{var Re=o=>{var f=wr(),R=t(f,!0);r(f),b(()=>{pr(f,1,`fixed top-4 right-4 z-50 rounded-lg p-4 shadow-lg ${e(de)==="success"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`),m(R,e(P))}),gr(3,f,()=>ur),d(o,f)};p(Ie,o=>{e(P)&&o(Re)})}var ke=i(Ie,2),Se=t(ke);{var Ne=o=>{var f=Ir();d(o,f)},Ye=(o,f)=>{{var R=B=>{var S=kr(),N=t(S),Y=t(N,!0);r(N);var K=i(N,2);r(S),b(()=>m(Y,e(ae))),T("click",K,()=>re("/auth/login")),d(B,S)},qe=(B,S)=>{{var N=Y=>{var K=zr(),ve=i(Pe(K),2),Ue=t(ve),ne=t(Ue),ze=t(ne);{var Je=a=>{var v=Ur();b(()=>{ee(v,"src",e(c).profileImage),ee(v,"alt",`${e(c).username??""}'s profile`)}),d(a,v)},Oe=a=>{var v=jr(),U=t(v,!0);r(v),b(q=>m(U,q),[()=>e(c).username.charAt(0).toUpperCase()],D),d(a,v)};p(ze,a=>{e(c).profileImage&&e(c).profileImage.length>2?a(Je):a(Oe,!1)})}r(ne);var je=i(ne,2),ce=t(je),Ve=t(ce,!0);r(ce);var me=i(ce,2),He=t(me,!0);r(me);var Ee=i(me,2),Ke=t(Ee);r(Ee),r(je),r(Ue),r(ve);var pe=i(ve,2),ge=i(t(pe),2),ue=t(ge);mr(ue);var Qe=i(ue,2);r(ge);var Ae=i(ge,2);{var We=a=>{var v=Er();d(a,v)};p(Ae,a=>{e(oe)&&a(We)})}var Xe=i(Ae,2);{var Ze=a=>{var v=Ar(),U=t(v,!0);r(v),b(()=>m(U,e(C))),d(a,v)};p(Xe,a=>{e(C)&&a(Ze)})}r(pe);var fe=i(pe,2),be=t(fe),$e=i(t(be),2);r(be);var er=i(be,2);{var rr=a=>{var v=Lr();d(a,v)},tr=(a,v)=>{{var U=_=>{var h=Dr(),z=t(h,!0);r(h),b(()=>m(z,e(H))),d(_,h)},q=(_,h)=>{{var z=I=>{var j=Gr();d(I,j)},g=I=>{var j=Cr();Be(j,5,()=>e(ie),Fe,(_e,u)=>{var E=Tr(),A=t(E),F=t(A);{var xe=n=>{var x=Pr();b(()=>{ee(x,"src",e(u).imageUrl),ee(x,"alt",e(u).name)}),d(n,x)},Q=n=>{var x=Br(),V=t(x,!0);r(x),b(L=>m(V,L),[()=>e(u).name.charAt(0).toUpperCase()],D),d(n,x)};p(F,n=>{e(u).imageUrl&&e(u).imageUrl.length>2?n(xe):n(Q,!1)})}var W=i(F,2),J=t(W),X=t(J,!0);r(J);var O=i(J,2),Z=t(O);r(O);var $=i(O,2);{var ye=n=>{var x=Fr(),V=t(x);r(x),b(L=>m(V,`Created: ${L??""}`),[()=>new Date(e(u).createdAt).toLocaleDateString()],D),d(n,x)};p($,n=>{e(u).createdAt&&n(ye)})}r(W),r(A);var w=i(A,2),k=t(w);r(w),r(E),b(()=>{m(X,e(u).name),m(Z,`${e(u).members.length??""} member${e(u).members.length!==1?"s":""}`)}),T("click",k,()=>re(`/groups/${e(u)._id}`)),d(_e,E)}),r(j),d(I,j)};p(_,I=>{e(ie).length===0?I(z):I(g,!1)},h)}};p(a,_=>{e(H)?_(U):_(q,!1)},v)}};p(er,a=>{e(M)?a(rr):a(tr,!1)})}r(fe);var Le=i(fe,2),ar=i(t(Le),2);{var or=a=>{var v=Mr();d(a,v)},sr=(a,v)=>{{var U=_=>{var h=Rr();d(_,h)},q=_=>{var h=qr();Be(h,5,()=>e(se),Fe,(z,g)=>{var I=cr(),j=Pe(I);{var _e=u=>{var E=Yr(),A=t(E),F=t(A),xe=t(F,!0);r(F);var Q=i(F,2);{var W=w=>{var k=Sr();const n=D(()=>e(g).members.find(L=>{var De,Ge;return typeof L.user=="object"?L.user._id===(((De=e(c))==null?void 0:De._id)||""):L.user===(((Ge=e(c))==null?void 0:Ge._id)||"")})),x=D(()=>e(n)&&e(n).addedBy?typeof e(n).addedBy=="object"?e(n).addedBy.username:"Unknown":typeof e(g).createdBy=="object"?e(g).createdBy.username:"Unknown");var V=t(k);r(k),b(()=>m(V,`Invited by: ${e(x)??""}`)),d(w,k)},J=w=>{var k=Nr(),n=t(k);r(k),b(()=>m(n,`Invited by: ${(typeof e(g).createdBy=="object"?e(g).createdBy.username:"Unknown")??""}`)),d(w,k)};p(Q,w=>{e(g).members&&e(g).members.length>0?w(W):w(J,!1)})}var X=i(Q,2),O=t(X);r(X),r(A);var Z=i(A,2),$=t(Z),ye=i($,2);r(Z),r(E),b(w=>{m(xe,e(g).name),m(O,`Invited: ${w??""}`)},[()=>e(g).createdAt?new Date(e(g).createdAt).toLocaleDateString():"Recently"],D),T("click",$,()=>we(e(g)._id,"accepted")),T("click",ye,()=>we(e(g)._id,"declined")),d(u,E)};p(j,u=>{e(g)&&u(_e)})}d(z,I)}),r(h),d(_,h)};p(a,_=>{e(se).length===0?_(U):_(q,!1)},v)}};p(ar,a=>{e(M)?a(or):a(sr,!1)})}r(Le),b(a=>{m(Ve,e(c).username),m(He,e(c).email),m(Ke,`Member since: ${a??""}`)},[()=>e(c).createdAt?new Date(e(c).createdAt).toLocaleDateString():"N/A"],D),fr(ue,()=>e(G),a=>s(G,a)),T("click",Qe,Me),T("click",$e,()=>re("/group/create")),d(Y,K)};p(B,Y=>{e(c)&&Y(N)},S)}};p(o,B=>{e(ae)?B(R):B(qe,!1)},f)}};p(Se,o=>{e(te)?o(Ne):o(Ye,!1)})}r(ke),r(le),d(Te,le),dr()}export{st as component};
